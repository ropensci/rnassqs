<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summary • rnassqs</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Summary"><meta property="og:image" content="/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="index.html">rnassqs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="articles/rnassqs.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/rnassqs/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Summary</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/rnassqs/blob/HEAD/paper.md" class="external-link"><code>paper.md</code></a></small>
    </div>


<div id="summary" class="section level1">

<p>The <a href="https://github.com/ropensci/rnassqs" class="external-link">rnassqs</a>
<code>R</code> package provides a simple interface for accessing the
United States Department of Agriculture National Agricultural Statistics
Service (USDA-NASS) ‘<a href="https://quickstats.nass.usda.gov/" class="external-link">Quick
Stats</a>’ API. The core functionality allows the user to query
agricultural data from ‘Quick Stats’ in a reproducible and automated
way. The primary benefit of <code>rnassqs</code> is that users need not
download data through repeated use of the Quick Stats point-and-click
interface, which reduces the chance of errors, eliminates the need for
repeated manual downloads of new data over time or space, and allows for
automated updates of web applications that rely on new releases of
USDA-NASS data over time.</p>
<p><code>rnassqs</code> manages API authentication by setting a system
environmental variable for the duration of the <code>R</code> session.
Convenience functions facilitate querying common data. Users can also
use <code>rnassqs</code> to query the list of data parameters and
available values for a given parameter (for example, to see the
commodities available in a particular county and year). The query
requests data as a JSON object and parses that data into a
<code>data.frame</code> object.</p>
</div>
<div class="section level1">
<h1 id="about-usda-nass-data-and-quick-stats">About USDA-NASS data and ‘Quick Stats’<a class="anchor" aria-label="anchor" href="#about-usda-nass-data-and-quick-stats"></a></h1>
<p>‘Quick Stats’ is a web interface to access data produced by
USDA-NASS. The data comes primarily from the Census of Agriculture, but
also includes data from USDA-NASS surveys on a wide range of topics. The
Census of Agriculture is conducted every five years in years ending in
‘2’ and ‘7’. The earliest year available on Quick Stats is 1997. Surveys
have different collection periods, but most are collected annually. Some
specific data such as the average value of agricultural land and
buildings by state is reported as early as 1850.</p>
<p>Aggregate data from the census and surveys is released primarily at
the national, state, and county level, though some data may be released
for congressional districts, watersheds, and zip codes. It includes a
range of data classified under five sectors: Animals &amp; Products,
Crops, Demographics, Economics, and Environmental. Examples of data
available in these sectors include counts of farms, farm operators,
acres of cropland, farm sales, farm expenses, and crop yields to name a
few.</p>
</div>
<div class="section level1">
<h1 id="benefits-of-rnassqs-over-quick-stats">Benefits of <code>rnassqs</code> over ‘Quick Stats’<a class="anchor" aria-label="anchor" href="#benefits-of-rnassqs-over-quick-stats"></a></h1>
<p>‘Quick Stats’ provides a number of selection fields in which the user
can select categories of data. Each selection causes the options in
other fields to update to reflect available options available options
based on other selections that the user has made. This makes the
selection of multiple different variables an at times frustrating
process. In addition, data requests are limited to 50,000 records. If a
user wants to access more records they must manually subset their data
request. For example, requesting crop yields by county for all counties
and census years for 1997 to 2017 requires either downloading each
state’s counties separately or, where possible, downloading all counties
for each year separately. The Quick Stats interface works well for quick
access or a single use. However, there are several cases in which the
‘Quick Stats’ interface is not ideal:</p>
<ul><li>Requests for a combination of measures, years, and geographies that
exceed 50,000 records.</li>
<li>Requests for newly released data that are identical to previous
requests.</li>
<li>Requests that are reproducible.</li>
</ul><p><code>rnassqs</code> addresses each of these issues by making the
‘Quick Stats’ API accessible with <code>R</code> code. This allows the
user to loop over a series of requests to address the first issue, to
execute (perhaps automated on a schedule) a data request repeatedly to
access new data with the same query to address the second, and to make
code available that allows others to reproducibly access the same data
to address the third.</p>
<p>For example, there are currently there are currently 332,125 records
of crop yields in all U.S. counties from 2000 to 2018. Accessing this
data through ‘Quick Stats’ would require manually selecting either a set
of years or a set of states to reduce each request to less than 50,000
records and then aggregating that data. With <code>rnassqs</code> this
can be done with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Access yields for all counties and all crops</span>
<span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sector_desc <span class="op">=</span> <span class="st">"CROPS"</span>,
               group_desc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FIELD CROPS"</span>, <span class="st">"FRUIT &amp; TREE NUTS"</span>, 
                              <span class="st">"HORTICULTURE"</span>, <span class="st">"VEGETABLES"</span><span class="op">)</span>,
               statisticcat_desc <span class="op">=</span> <span class="st">"YIELD"</span>, 
               agg_level_desc <span class="op">=</span> <span class="st">"COUNTY"</span><span class="op">)</span>

<span class="co"># Get all years from 2000 to 2018 in a list of data.frames</span>
<span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">:</span><span class="fl">2018</span>, <span class="kw">function</span><span class="op">(</span><span class="va">yr</span><span class="op">)</span> <span class="op">{</span> 
  <span class="va">params</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">yr</span>
  <span class="fu">rnassqs</span><span class="fu">::</span><span class="fu"><a href="reference/nassqs.html">nassqs</a></span><span class="op">(</span><span class="va">params</span>, url_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># Aggregate the list of data.frames into a single data.frame</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">data_list</span><span class="op">)</span></code></pre></div>
<p>This results in significant time savings, increases the
reproducibility of the data, and allows for easy updating of the request
when a new year is made available.</p>
</div>
<div class="section level1">
<h1 id="alternatives-to-rnassqs">Alternatives to <code>rnassqs</code>
<a class="anchor" aria-label="anchor" href="#alternatives-to-rnassqs"></a></h1>
<p>USDA-NASS also provides FTP access to text data files<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. By accessing the data
via FTP users can avoid using the selection interface of ‘Quick Stats’
and avoid limitations on the number of records per request, but do not
resolve issues of automated repeated requests or of making data requests
reproducible. Other <code>R</code> packages have also been released
since the development of <code>rnassqs</code> that provide access to
Quick Stats data, though somewhat differently, include
<code>usdarnass</code> and <code>tidyUSDA</code>, which uses US Census
maps to create maps of Quick Stats data.</p>
</div>
<div class="section level1">
<h1 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a></h1>
<p>Thank you to Jonathan Adams, Julia Piaskowski, and Joseph Stachelek
for code contributions. A huge thanks to reviewers Adam H Sparks and
Neal Richardson for their thoughtful feedback to improve the package and
documentation.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr><ol><li id="fn1"><p>Available at: <a href="ftp://ftp.nass.usda.gov/quickstats/">ftp://ftp.nass.usda.gov/quickstats/</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol></div>


  </main></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://twitter.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-twitter"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

